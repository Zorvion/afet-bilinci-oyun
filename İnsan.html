<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ä°nsan KaynaklÄ± Afetler - Afet Bilinci</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f1724 0%, #1f2937 50%, #0f1724 100%);
      color: #fff;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      transition: background 0.5s ease;
    }

    body.bg-correct {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
    }

    body.bg-wrong {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
    }

    header {
      background: linear-gradient(135deg, #7c2d12 0%, #9a3412 100%);
      padding: 18px 24px;
      box-shadow: 0 8px 32px rgba(124, 45, 18, 0.4);
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 2px solid rgba(255,255,255,0.1);
    }
    header h1 { 
      margin: 0; 
      font-size: 24px; 
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .nav-buttons {
      display: flex;
      gap: 10px;
    }
    .navbtn { 
      background: rgba(11, 18, 32, 0.8);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.2);
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .navbtn:hover {
      background: rgba(11, 18, 32, 1);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    main { 
      padding: 32px 24px; 
      max-width: 1200px; 
      margin: 0 auto; 
    }

    .intro-text {
      text-align: center;
      font-size: 16px;
      color: #94a3b8;
      margin-bottom: 32px;
      padding: 16px;
      background: rgba(15, 23, 36, 0.6);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.05);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin-bottom: 32px;
    }

    .tile {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.8));
      padding: 24px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      cursor: pointer;
      transition: all 0.4s ease;
      border: 2px solid transparent;
      position: relative;
    }

    .tile:hover {
      transform: translateY(-12px) scale(1.02);
      border-color: rgba(14, 165, 164, 0.5);
      box-shadow: 0 20px 40px rgba(14, 165, 164, 0.3);
    }

    .tile-icon {
      font-size: 48px;
      margin-bottom: 12px;
      display: block;
    }

    .tile h3 { 
      margin: 8px 0 12px; 
      color: #fed7aa; 
      font-size: 22px;
      font-weight: 700;
    }

    .tile p { 
      margin: 0; 
      color: #cbd5e1; 
      font-size: 14px; 
      line-height: 1.6;
    }

    .tile.selected {
      border-color: #0ea5a4;
      background: linear-gradient(145deg, rgba(14, 165, 164, 0.2), rgba(15, 23, 42, 0.9));
      box-shadow: 0 20px 40px rgba(14, 165, 164, 0.4);
    }

    #detail {
      margin-top: 32px;
      padding: 28px;
      background: linear-gradient(145deg, rgba(7, 16, 36, 0.95), rgba(15, 23, 36, 0.95));
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.7);
      border: 1px solid rgba(255,255,255,0.08);
      min-height: 300px;
    }

    #detail h2 { 
      margin-top: 0; 
      color: #ffedd5; 
      font-size: 28px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .info-card {
      background: rgba(14, 165, 164, 0.1);
      border-left: 4px solid #0ea5a4;
      padding: 16px;
      border-radius: 8px;
      margin: 16px 0;
      color: #e0f2f1;
      line-height: 1.7;
    }

    .btn {
      display: inline-block;
      margin: 12px 12px 0 0;
      background: linear-gradient(135deg, #0ea5a4 0%, #0891b2 100%);
      color: #042027;
      border: none;
      padding: 14px 28px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(14, 165, 164, 0.4);
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(14, 165, 164, 0.6);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn.secondary { 
      background: linear-gradient(135deg, #1f6feb 0%, #3b82f6 100%);
      color: #fff;
      box-shadow: 0 4px 12px rgba(31, 111, 235, 0.4);
    }

    .game-area { 
      margin-top: 24px; 
      background: linear-gradient(145deg, rgba(7, 17, 38, 0.9), rgba(2, 16, 36, 0.9));
      padding: 28px; 
      border-radius: 16px;
      border: 1px solid rgba(14, 165, 164, 0.3);
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #0ea5a4, #22c55e);
      transition: width 0.5s ease;
      box-shadow: 0 0 10px rgba(14, 165, 164, 0.8);
    }

    .q { 
      font-size: 20px; 
      margin-bottom: 24px; 
      color: #e6f7ff; 
      font-weight: 600;
      line-height: 1.6;
      padding: 16px;
      background: rgba(14, 165, 164, 0.05);
      border-radius: 12px;
      border-left: 4px solid #0ea5a4;
    }

    .choice { 
      display: block; 
      width: 100%; 
      text-align: left; 
      margin: 12px 0; 
      padding: 16px 20px; 
      background: linear-gradient(135deg, rgba(9, 34, 58, 0.8), rgba(7, 25, 45, 0.8));
      color: #dbeafe; 
      border-radius: 12px; 
      border: 2px solid rgba(255,255,255,0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      font-weight: 500;
    }

    .choice:hover { 
      transform: translateX(8px);
      background: linear-gradient(135deg, rgba(14, 165, 164, 0.2), rgba(9, 34, 58, 0.9));
      border-color: rgba(14, 165, 164, 0.5);
    }

    .choice:disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }

    .result { 
      font-size: 18px; 
      margin-top: 20px; 
      color: #f1f5f9;
      line-height: 1.8;
    }

    .result ul {
      background: rgba(0,0,0,0.3);
      padding: 20px 20px 20px 40px;
      border-radius: 12px;
      margin-top: 16px;
    }

    .result li {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .score-display {
      display: inline-block;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      padding: 12px 24px;
      border-radius: 12px;
      font-size: 24px;
      font-weight: 700;
      margin: 16px 0;
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
    }

    .congrats {
      font-size: 48px;
      text-align: center;
      margin: 20px 0;
    }

    @media(max-width: 768px) {
      header h1 { font-size: 18px; }
      .tile h3 { font-size: 18px; }
      .q { font-size: 18px; }
      main { padding: 20px 16px; }
    }
  </style>
</head>
<body>

  <header>
    <h1>ğŸ‘¥ Ä°nsan KaynaklÄ± Afetler - Yeni Nesil EÄŸitim</h1>
    <div class="nav-buttons">
      <button class="navbtn" id="homeBtn">ğŸ  Ana Sayfa</button>
      <button class="navbtn" id="aboutBtn">â„¹ï¸ HakkÄ±nda</button>
    </div>
  </header>

  <main>
    <div class="intro-text">
      ğŸ¯ <strong>AÅŸaÄŸÄ±dan bir afet tÃ¼rÃ¼ seÃ§:</strong> Bilgi kartÄ±nÄ± okuyarak Ã¶ÄŸren veya "Oyna" butonuyla 5 soruluk interaktif testi baÅŸlat!
    </div>

    <div class="grid" id="tiles">
      <div class="tile" id="tile-yangin">
        <span class="tile-icon">ğŸ”¥</span>
        <h3>YangÄ±n</h3>
        <p>Ev, orman ve sanayi yangÄ±nlarÄ±, yangÄ±n sÃ¶ndÃ¼rme ve tahliye yÃ¶ntemleri.</p>
      </div>

      <div class="tile" id="tile-kimyasal">
        <span class="tile-icon">ğŸ§ª</span>
        <h3>Kimyasal SÄ±zÄ±ntÄ±</h3>
        <p>EndÃ¼striyel kazalar, kimyasal madde sÄ±zÄ±ntÄ±larÄ± ve acil mÃ¼dahale protokolleri.</p>
      </div>

      <div class="tile" id="tile-nukleer">
        <span class="tile-icon">â˜¢ï¸</span>
        <h3>NÃ¼kleer Kazalar</h3>
        <p>Radyoaktif sÄ±zÄ±ntÄ±lar, nÃ¼kleer santral kazalarÄ± ve korunma yÃ¶ntemleri.</p>
      </div>
    </div>

    <div id="detail">
      <h2 id="detailTitle">ğŸ® Bir Afet TÃ¼rÃ¼ SeÃ§in</h2>
      <p id="detailText" style="color:#94a3b8; font-size:16px;">YukarÄ±daki kartlardan birini seÃ§erek bilgi alabilir veya oyunu baÅŸlatabilirsiniz.</p>

      <div id="detailButtons"></div>

      <div id="game" class="game-area" style="display:none;">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width:0%"></div>
        </div>
        <div id="qbox"></div>
        <div id="choicesBox"></div>
        <div id="after" style="display:none;">
          <div class="result" id="resultText"></div>
          <button class="btn secondary" id="backBtn">ğŸ”™ BaÅŸka Afet SeÃ§</button>
        </div>
      </div>
    </div>
  </main>

<script>
  var data = {
    yangin: [
      { q: "YangÄ±n Ã§Ä±ktÄ±ÄŸÄ±nÄ± fark ettiÄŸinizde ilk yapmanÄ±z gereken nedir?", opts: ["YangÄ±n alarmÄ±nÄ± Ã§alÄ±ÅŸtÄ±rÄ±n ve itfaiyeyi arayÄ±n", "YangÄ±nÄ± kendiniz sÃ¶ndÃ¼rmeye Ã§alÄ±ÅŸÄ±n", "EÅŸyalarÄ±nÄ±zÄ± kurtarmaya Ã§alÄ±ÅŸÄ±n"], a: 0, explain: "Ã–ncelikle yangÄ±n alarmÄ± ve itfaiye Ã§aÄŸrÄ±sÄ± yapÄ±lmalÄ±, gÃ¼venlik saÄŸlanmalÄ±dÄ±r." },
      { q: "YangÄ±n sÄ±rasÄ±nda kapalÄ± alandaysanÄ±z ne yapmalÄ±sÄ±nÄ±z?", opts: ["KapÄ±yÄ± kapatÄ±p Ä±slak bezle sÄ±zdÄ±rmazlÄ±k saÄŸlayÄ±n", "Pencereyi aÃ§arak dumanÄ± Ã§Ä±karmaya Ã§alÄ±ÅŸÄ±n", "AsansÃ¶re koÅŸun"], a: 0, explain: "KapÄ±yÄ± kapatmak ve sÄ±zdÄ±rmazlÄ±k yangÄ±nÄ±n yayÄ±lmasÄ±nÄ± yavaÅŸlatÄ±r." },
      { q: "YangÄ±n sÃ¶ndÃ¼rÃ¼cÃ¼yÃ¼ nasÄ±l kullanmalÄ±sÄ±nÄ±z?", opts: ["PÃœSKÃœRT - PÄ°MÄ° Ã‡EK - TETÄ°ÄE BAS", "TetiÄŸe basÄ±p yangÄ±na doÄŸru tut", "Rastgele sallayarak kullan"], a: 0, explain: "PÃœSKÃœRT metodunu kullanarak yangÄ±n sÃ¶ndÃ¼rÃ¼cÃ¼yÃ¼ doÄŸru ÅŸekilde kullanabilirsiniz." },
      { q: "Duman dolu bir ortamda nasÄ±l hareket etmelisiniz?", opts: ["Yere yakÄ±n sÃ¼rÃ¼nerek ilerleyin", "Ayakta hÄ±zlÄ±ca yÃ¼rÃ¼yÃ¼n", "KoÅŸarak Ã§Ä±kÄ±ÅŸa ulaÅŸmaya Ã§alÄ±ÅŸÄ±n"], a: 0, explain: "Duman yukarÄ±da toplanÄ±r, yere yakÄ±n hareket etmek daha gÃ¼venlidir." },
      { q: "Elektrik yangÄ±nÄ±nda hangi yangÄ±n sÃ¶ndÃ¼rÃ¼cÃ¼ kullanÄ±lmalÄ±dÄ±r?", opts: ["Karbondioksit (CO2) veya kuru kimyevi toz", "Su", "Kum"], a: 0, explain: "Elektrik yangÄ±nlarÄ±nda su iletken olduÄŸu iÃ§in tehlikelidir, CO2 veya kuru kimyevi toz kullanÄ±lmalÄ±dÄ±r." }
    ],
    kimyasal: [
      { q: "Kimyasal sÄ±zÄ±ntÄ± uyarÄ±sÄ± aldÄ±ÄŸÄ±nÄ±zda ne yapmalÄ±sÄ±nÄ±z?", opts: ["Ä°Ã§eri girip kapÄ± ve pencereleri kapatÄ±n", "DÄ±ÅŸarÄ± Ã§Ä±kÄ±p sÄ±zÄ±ntÄ±yÄ± gÃ¶zlemleyin", "Hemen bÃ¶lgeden uzaklaÅŸmaya Ã§alÄ±ÅŸÄ±n"], a: 0, explain: "KapalÄ± alanlarda kalmak kimyasal maddelerden korunmak iÃ§in en gÃ¼venli yoldur." },
      { q: "Kimyasal sÄ±zÄ±ntÄ± sÄ±rasÄ±nda hangi malzemeleri kullanmalÄ±sÄ±nÄ±z?", opts: ["Maske ve koruyucu giysi", "Sadece eldiven", "Normal kÄ±yafetler"], a: 0, explain: "Kimyasal maddelere karÅŸÄ± tam koruma saÄŸlayan ekipmanlar kullanÄ±lmalÄ±dÄ±r." },
      { q: "Kimyasal madde bulaÅŸmÄ±ÅŸ giysiler nasÄ±l Ã§Ä±karÄ±lmalÄ±dÄ±r?", opts: ["Makasla kesilerek Ã§Ä±karÄ±lÄ±r", "Normal ÅŸekilde Ã§Ä±karÄ±lÄ±r", "Ãœzerine su dÃ¶kÃ¼lerek Ã§Ä±karÄ±lÄ±r"], a: 0, explain: "Kimyasal bulaÅŸmÄ±ÅŸ giysiler kesilerek Ã§Ä±karÄ±lmalÄ±, ciltle temas ettirilmemelidir." },
      { q: "Kimyasal sÄ±zÄ±ntÄ± sonrasÄ± su kaynaklarÄ± ne yapÄ±lmalÄ±dÄ±r?", opts: ["KullanÄ±lmadan Ã¶nce test edilmeli", "Hemen kullanÄ±lmalÄ±", "KaynatÄ±larak kullanÄ±lmalÄ±"], a: 0, explain: "Kimyasal sÄ±zÄ±ntÄ± sonrasÄ± su kaynaklarÄ± kirlenmiÅŸ olabilir, test edilmeden kullanÄ±lmamalÄ±dÄ±r." },
      { q: "Kimyasal sÄ±zÄ±ntÄ± durumunda hangi numara aranmalÄ±dÄ±r?", opts: ["112 Acil Ã‡aÄŸrÄ± Merkezi", "155 Polis", "177 Orman YangÄ±nÄ±"], a: 0, explain: "TÃ¼m acil durumlar iÃ§in 112 Acil Ã‡aÄŸrÄ± Merkezi aranmalÄ±dÄ±r." }
    ],
    nukleer: [
      { q: "NÃ¼kleer santral kazasÄ± uyarÄ±sÄ± verildiÄŸinde ne yapmalÄ±sÄ±nÄ±z?", opts: ["KapalÄ± alana girip havalandÄ±rmayÄ± kapatÄ±n", "Hemen bÃ¶lgeden uzaklaÅŸÄ±n", "DÄ±ÅŸarÄ± Ã§Ä±kÄ±p durumu gÃ¶zlemleyin"], a: 0, explain: "Radyoaktif maddelerden korunmak iÃ§in kapalÄ± alanlarda kalÄ±nmalÄ±dÄ±r." },
      { q: "Radyoaktif serpinti riski varsa ne yapmalÄ±sÄ±nÄ±z?", opts: ["Ä°yot tabletleri kullanÄ±n", "Bol su iÃ§in", "HiÃ§bir ÅŸey yapmayÄ±n"], a: 0, explain: "Ä°yot tabletleri tiroid bezinin radyoaktif iyot emilimini engeller." },
      { q: "NÃ¼kleer kaza sonrasÄ± dÄ±ÅŸarÄ± Ã§Ä±karken nelere dikkat edilmeli?", opts: ["Yetkililerin talimatlarÄ±nÄ± bekleyin", "Hemen dÄ±ÅŸarÄ± Ã§Ä±kÄ±n", "Sadece kÄ±sa sÃ¼reliÄŸine Ã§Ä±kÄ±n"], a: 0, explain: "Radyasyon seviyeleri yetkililerce kontrol edilmelidir." },
      { q: "Radyoaktif madde bulaÅŸmÄ±ÅŸ giysiler nasÄ±l deÄŸerlendirilir?", opts: ["Ã–zel olarak paketlenip imha edilmeli", "YÄ±kanÄ±p tekrar kullanÄ±lmalÄ±", "OlduÄŸu gibi saklanmalÄ±"], a: 0, explain: "Radyoaktif bulaÅŸmÄ±ÅŸ giysiler Ã¶zel prosedÃ¼rlerle imha edilmelidir." },
      { q: "NÃ¼kleer acil durum Ã§antasÄ±nda ne bulunmalÄ±dÄ±r?", opts: ["Radyasyon Ã¶lÃ§er, iyot tabletleri, su", "Sadece yiyecek", "Sadece su"], a: 0, explain: "NÃ¼kleer acil durumlar iÃ§in Ã¶zel ekipmanlar gereklidir." }
    ]
  };

  var currentType = null;
  var sceneIndex = 0;
  var score = 0;
  var mistakes = [];
  var isAnswering = false;

  function selectDisaster(type) {
    currentType = type;
    sceneIndex = 0;
    score = 0;
    mistakes = [];
    isAnswering = false;

    var tiles = document.querySelectorAll('.tile');
    for (var i = 0; i < tiles.length; i++) {
      tiles[i].classList.remove('selected');
    }
    document.getElementById('tile-' + type).classList.add('selected');

    var titles = {
      yangin: "ğŸ”¥ YangÄ±n",
      kimyasal: "ğŸ§ª Kimyasal SÄ±zÄ±ntÄ±",
      nukleer: "â˜¢ï¸ NÃ¼kleer Kazalar"
    };

    var infos = {
      yangin: "YangÄ±n durumunda <strong>ilk Ã¶nce alarmÄ± Ã§alÄ±ÅŸtÄ±rÄ±n ve itfaiyeyi arayÄ±n</strong>. DumanlÄ± ortamda yere yakÄ±n hareket edin.",
      kimyasal: "Kimyasal sÄ±zÄ±ntÄ±larda <strong>iÃ§eri girip kapÄ± ve pencereleri kapatÄ±n</strong>. Maske ve koruyucu giysi kullanÄ±n.",
      nukleer: "NÃ¼kleer kazalarda <strong>kapalÄ± alanda kalÄ±n ve havalandÄ±rmayÄ± kapatÄ±n</strong>. Ä°yot tabletleri kullanÄ±n."
    };

    document.getElementById('detailTitle').innerHTML = titles[type];
    document.getElementById('detailText').innerHTML = '<div class="info-card">' + infos[type] + '</div>';

    var db = document.getElementById('detailButtons');
    db.innerHTML = '';

    var playBtn = document.createElement('button');
    playBtn.className = 'btn';
    playBtn.innerHTML = 'â–¶ï¸ Oyunu BaÅŸlat';
    playBtn.addEventListener('click', function() {
      startGame(type);
    });
    db.appendChild(playBtn);

    var infoBtn = document.createElement('button');
    infoBtn.className = 'btn secondary';
    infoBtn.innerHTML = 'ğŸ“‹ DetaylÄ± Bilgi';
    infoBtn.addEventListener('click', function() {
      showInfoCard(type);
    });
    db.appendChild(infoBtn);

    document.getElementById('game').style.display = 'none';
    document.getElementById('after').style.display = 'none';
  }

  function showInfoCard(type) {
    var detailedInfo = {
      yangin: "<h3 style='color:#0ea5a4;'>ğŸ“š YangÄ±n HakkÄ±nda</h3><p>KontrolsÃ¼z yanma olayÄ± olup can ve mal kaybÄ±na neden olur.</p><ul style='text-align:left;'><li><strong>Ã–ncesi:</strong> YangÄ±n sÃ¶ndÃ¼rÃ¼cÃ¼ bulundurun, kaÃ§Ä±ÅŸ planÄ± yapÄ±n</li><li><strong>SÄ±rasÄ±nda:</strong> AlarmÄ± Ã§alÄ±ÅŸtÄ±rÄ±n, itfaiyeyi arayÄ±n, duman altÄ±nda sÃ¼rÃ¼nÃ¼n</li><li><strong>SonrasÄ±:</strong> Yetkililer izin verene kadar binaya girmeyin</li></ul>",
      kimyasal: "<h3 style='color:#0ea5a4;'>ğŸ“š Kimyasal SÄ±zÄ±ntÄ± HakkÄ±nda</h3><p>EndÃ¼striyel kazalar sonucu tehlikeli kimyasallarÄ±n Ã§evreye yayÄ±lmasÄ±.</p><ul style='text-align:left;'><li><strong>Risk:</strong> Zehirlenme, yanÄ±klar, patlama</li><li><strong>Korunma:</strong> KapalÄ± alanda kalÄ±n, maske kullanÄ±n</li><li><strong>Ä°lk yardÄ±m:</strong> 112'yi arayÄ±n, kimyasal bulaÅŸmÄ±ÅŸ giysileri Ã§Ä±karÄ±n</li></ul>",
      nukleer: "<h3 style='color:#0ea5a4;'>ğŸ“š NÃ¼kleer Kazalar HakkÄ±nda</h3><p>NÃ¼kleer santrallerdeki arÄ±zalar sonucu radyoaktif madde sÄ±zÄ±ntÄ±sÄ±.</p><ul style='text-align:left;'><li><strong>Tehlike:</strong> Radyasyon hastalÄ±ÄŸÄ±, kanser riski</li><li><strong>Korunma:</strong> KapalÄ± alanda kalÄ±n, iyot tableti kullanÄ±n</li><li><strong>SonrasÄ±:</strong> Yetkililerin talimatlarÄ±nÄ± bekleyin</li></ul>"
    };

    document.getElementById('detailText').innerHTML = '<div class="info-card">' + detailedInfo[type] + '</div>';
  }

  function startGame(type) {
    currentType = type;
    sceneIndex = 0;
    score = 0;
    mistakes = [];
    isAnswering = false;

    document.getElementById('game').style.display = 'block';
    document.getElementById('after').style.display = 'none';
    renderScene();
  }

  function renderScene() {
    var scenes = data[currentType];
    if (!scenes) return;

    if (sceneIndex >= scenes.length) {
      return finishGame();
    }

    var scene = scenes[sceneIndex];
    var progress = ((sceneIndex + 1) / scenes.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';

    var qbox = document.getElementById('qbox');
    qbox.innerHTML = '<div class="q">Soru ' + (sceneIndex + 1) + ' / ' + scenes.length + ': ' + scene.q + '</div>';

    var choicesBox = document.getElementById('choicesBox');
    choicesBox.innerHTML = '';

    for (var i = 0; i < scene.opts.length; i++) {
      var btn = document.createElement('button');
      btn.className = 'choice';
      btn.textContent = scene.opts[i];
      btn.setAttribute('data-index', i);
      btn.addEventListener('click', function() {
        if (!isAnswering) {
          var selectedIndex = parseInt(this.getAttribute('data-index'));
          chooseAnswer(selectedIndex);
        }
      });
      choicesBox.appendChild(btn);
    }
  }

  function chooseAnswer(selectedIndex) {
    if (isAnswering) return;
    isAnswering = true;

    var scene = data[currentType][sceneIndex];
    var isCorrect = (selectedIndex === scene.a);

    var choices = document.querySelectorAll('.choice');
    for (var i = 0; i < choices.length; i++) {
      choices[i].disabled = true;
    }

    var body = document.body;
    if (isCorrect) {
      body.classList.add('bg-correct');
      score++;
    } else {
      body.classList.add('bg-wrong');
      mistakes.push({
        index: sceneIndex + 1,
        q: scene.q,
        selected: scene.opts[selectedIndex],
        correct: scene.opts[scene.a],
        why: scene.explain
      });
    }

    setTimeout(function() {
      body.classList.remove('bg-correct', 'bg-wrong');
      sceneIndex++;
      isAnswering = false;
      renderScene();
    }, 1000);
  }

  function finishGame() {
    document.getElementById('game').style.display = 'block';
    document.getElementById('after').style.display = 'block';
    document.getElementById('qbox').innerHTML = '';
    document.getElementById('choicesBox').innerHTML = '';

    var total = data[currentType].length;
    var res = document.getElementById('resultText');
    var txt = '';

    if (mistakes.length === 0) {
      txt = '<div class="congrats">ğŸ‰</div><div class="score-display">MÃ¼kemmel: ' + score + '/' + total + '</div><p>Tebrikler! TÃ¼m sorular doÄŸru!</p>';
    } else {
      txt = '<div class="score-display">Skor: ' + score + '/' + total + '</div>';
      txt += '<p><strong>YanlÄ±ÅŸ yaptÄ±ÄŸÄ±n sorular:</strong></p><ul style="text-align:left;">';
      for (var i = 0; i < mistakes.length; i++) {
        var m = mistakes[i];
        txt += '<li><b>Soru ' + m.index + ':</b> ' + m.q + '<br>';
        txt += '<span style="color:#ff9999">âŒ Senin cevabÄ±n: ' + m.selected + '</span><br>';
        txt += '<span style="color:#99ff99">âœ… DoÄŸru cevap: ' + m.correct + '</span><br>';
        txt += '<small style="color:#9aa5b1">ğŸ’¡ ' + m.why + '</small></li>';
      }
      txt += '</ul>';
    }
    res.innerHTML = txt;
  }

  function backToSelection() {
    document.getElementById('game').style.display = 'none';
    document.getElementById('after').style.display = 'none';
    document.getElementById('detailTitle').innerHTML = 'ğŸ® Bir Afet TÃ¼rÃ¼ SeÃ§in';
    document.getElementById('detailText').innerHTML = '<p style="color:#94a3b8; font-size:16px;">YukarÄ±daki kartlardan birini seÃ§erek bilgi alabilir veya oyunu baÅŸlatabilirsiniz.</p>';
    document.getElementById('detailButtons').innerHTML = '';

    var tiles = document.querySelectorAll('.tile');
    for (var i = 0; i < tiles.length; i++) {
      tiles[i].classList.remove('selected');
    }

    currentType = null;
    sceneIndex = 0;
    score = 0;
    mistakes = [];
    isAnswering = false;
  }

  document.getElementById('tile-yangin').addEventListener('click', function() {
    selectDisaster('yangin');
  });

  document.getElementById('tile-kimyasal').addEventListener('click', function() {
    selectDisaster('kimyasal');
  });

  document.getElementById('tile-nukleer').addEventListener('click', function() {
    selectDisaster('nukleer');
  });

  document.getElementById('homeBtn').addEventListener('click', function() {
    window.location.href = 'index.html';
  });

  document.getElementById('aboutBtn').addEventListener('click', function() {
    window.location.href = 'hakkinda.html';
  });

  document.getElementById('backBtn').addEventListener('click', backToSelection);
</script>

</body>
</html>