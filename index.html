<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Afet Bilinci Oyunu - GeliÅŸtirilmiÅŸ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #eef3f7;
            margin-top: 50px;
        }
        h1 { color: #222; }
        button {
            margin: 10px;
            padding: 10px 25px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            transition: 0.2s;
        }
        button:hover { background-color: #0056b3; }
        /* SonuÃ§ ekranÄ± stil dÃ¼zenlemeleri */
        ul { text-align: left; max-width: 500px; margin: 20px auto; padding-left: 20px; list-style-type: none; }
        li { margin-bottom: 15px; padding: 5px; border-left: 3px solid orange; }
        .correct-answer { color: green; font-weight: bold; }
        .wrong-answer { color: red; }
    </style>
</head>
<body>

    <h1 id="title">Afet Bilinci Oyunu</h1>
    <div id="choices">
        <button onclick="start('deprem')">ðŸŒ‹ Deprem Senaryosu</button>
        <button onclick="start('yangin')">ðŸ”¥ YangÄ±n Senaryosu</button>
    </div>

    <script>
        let score = 0;
        let step = 0; // Sorun olmamasÄ± iÃ§in senin kodundaki gibi 0'dan baÅŸlÄ±yor
        let type = "";
        let mistakes = [];
        let maxScorePerGame = 0;

        const scenes = {
            deprem: [
                { q: "Deprem baÅŸladÄ±! Ne yaparsÄ±n?", o: ["KaÃ§arak dÄ±ÅŸarÄ± Ã§Ä±k", "Ã‡Ã¶k, Kapan, Tutun", "CamÄ±n yanÄ±nda dur"], c: 2 },
                { q: "KapalÄ± alandasÄ±n. Dolap devriliyor, en doÄŸru davranÄ±ÅŸ nedir?", o: ["DolabÄ± tutmaya Ã§alÄ±ÅŸ", "SaÄŸlam bir eÅŸyanÄ±n yanÄ±nda koruma pozisyonu al", "Pencereye koÅŸ"], c: 2 },
                { q: "SarsÄ±ntÄ± bitti ve duruldu. Ne yapmalÄ±sÄ±n?", o: ["Hemen eve girip kontrol et", "DÄ±ÅŸarÄ± Ã§Ä±k ve toplanma alanÄ±na git", "Hemen komÅŸulara haber ver"], c: 2 },
                { q: "Toplanma alanÄ±ndasÄ±n. ArtÃ§Ä± sarsÄ±ntÄ±lar baÅŸladÄ±, ne yaparsÄ±n?", o: ["Panik yapÄ±p koÅŸ", "SarsÄ±ntÄ± bitene kadar aÃ§Ä±k alanda gÃ¼venli pozisyonu koru", "YÃ¼ksek binalara yaklaÅŸ"], c: 2 },
                { q: "Acil bir durum iÃ§in ne zaman ve hangi vanayÄ± kapatmalÄ±sÄ±n?", o: ["SarsÄ±ntÄ± sÄ±rasÄ±nda gaz vanasÄ±nÄ±", "SarsÄ±ntÄ± durduktan sonra gaz, elektrik ve su vanasÄ±nÄ±", "Sadece su vanasÄ±nÄ±"], c: 2 }
            ],
            yangin: [
                { q: "Evde yangÄ±n Ã§Ä±ktÄ±! Ä°lk eylemin ne olmalÄ±?", o: ["Hemen su dÃ¶k", "AlarmÄ± Ã§alÄ±ÅŸtÄ±r ve kaÃ§Ä±ÅŸ yolunu kullanarak Ã§Ä±k", "Pencereyi aÃ§Ä±p hava girmesini saÄŸla"], c: 2 },
                { q: "Duman yayÄ±lÄ±yor. NasÄ±l ilerlemelisin?", o: ["Ayakta hÄ±zlÄ±ca koÅŸ", "EÄŸilerek, sÃ¼rÃ¼nerek ve aÄŸzÄ±nÄ± kapatarak ilerle", "AsansÃ¶re binmeye Ã§alÄ±ÅŸ"], c: 2 },
                { q: "Bir kapÄ±ya ulaÅŸtÄ±n. KapÄ±yÄ± aÃ§madan Ã¶nce ne yapmalÄ±sÄ±n?", o: ["Hemen kapÄ±yÄ± aÃ§", "KapÄ±nÄ±n sÄ±caklÄ±ÄŸÄ±nÄ± elinin arkasÄ±yla kontrol et", "Geri dÃ¶n ve baÅŸka yol ara"], c: 2 },
                { q: "BaÅŸarÄ±yla dÄ±ÅŸarÄ± Ã§Ä±ktÄ±n. Ä°lk kime haber vermelisin?", o: ["KomÅŸuna", "112'yi (veya 110 Ä°tfaiye) ara ve durumu bildir", "Sosyal medyada paylaÅŸ"], c: 2 },
                { q: "YangÄ±n sÃ¶ndÃ¼rÃ¼ldÃ¼. Eve geri girmeli misin?", o: ["Evet, eÅŸyalarÄ±nÄ± kontrol etmek iÃ§in", "HayÄ±r, yetkililerin iznini beklemelisin", "Sadece kapÄ±yÄ± arala ve bak"], c: 2 }
            ]
        };

        function start(t) {
            type = t;
            score = 0;
            step = 0; // Senaryo dizisi endeksini 0'dan baÅŸlat
            mistakes = [];
            maxScorePerGame = scenes[type].length;
            showScene();
        }

        function showScene() {
            const data = scenes[type];
            const title = document.getElementById("title");
            const choices = document.getElementById("choices");

            if (step >= data.length) return showResult();

            const scene = data[step];
            // Soru numarasÄ±nÄ± ekledik ve $ hatasÄ± dÃ¼zeltildi
            title.innerText = Soru ${step + 1}/${data.length}: ${scene.q};
            choices.innerHTML = "";

            scene.o.forEach((opt, i) => {
                const btn = document.createElement("button");
                btn.textContent = opt;
                // Cevap kontrolÃ¼ ve hatanÄ±n kaydedilmesi iÃ§in fonksiyon Ã§aÄŸrÄ±lÄ±yor
                btn.onclick = () => handleAnswer(i + 1, scene.c, scene.q, opt, scene.o[scene.c - 1]);
                choices.appendChild(btn);
            });
        }

        function handleAnswer(choice, correct, question, selectedOption, correctAnswerText) {
            if (choice === correct) {
                score++;
            } else {
                // HatalÄ± cevabÄ± ve doÄŸru cevabÄ± kaydet
                mistakes.push({
                    question: question,
                    selected: selectedOption,
                    correct: correctAnswerText
                });
            }
            step++;
            showScene();
        }

        function showResult() {
            const pct = Math.round((score / maxScorePerGame) * 100);
            const title = document.getElementById("title");
            const choices = document.getElementById("choices");
            title.innerText = ${type.charAt(0).toUpperCase() + type.slice(1)} Senaryosu Bitti!;

            const hatalar = mistakes.length
                ? mistakes.map(m => `
                    <li>
                        <b>Soru:</b> ${m.question}<br>
                        <b>Senin CevabÄ±n:</b> <span class="wrong-answer">${m.selected}</span><br>
                        <b>DoÄŸru Cevap:</b> <span class="correct-answer">${m.correct}</span>
                    </li>
                  `).join("")
                : "<li>HiÃ§ hata yapmadÄ±n, afet bilincin mÃ¼kemmel!</li>";

            choices.innerHTML = `
                <p style="font-size:24px; margin-bottom: 25px;">
                    Afet Bilinci BaÅŸarÄ± PuanÄ±n: 
                    <b style="color: ${pct >= 80 ? 'green' : (pct >= 50 ? 'orange' : 'red')};">
                        %${pct}
                    </b>
                    <br>(${score} DoÄŸru / ${maxScorePerGame} Soru)
                </p>
                
                <h3>GÃ¶zden GeÃ§irmen Gerekenler (${mistakes.length} YanlÄ±ÅŸ DavranÄ±ÅŸ):</h3>
                <ul>${hatalar}</ul>
                <button onclick="window.location.reload()">Ana MenÃ¼ye DÃ¶n</button>
            `;
        }
    </script>

</body>
</html>
