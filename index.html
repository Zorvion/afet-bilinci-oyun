<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Afet Bilinci Simülasyonu | Dinamik Sürüm</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --main-bg-color: #f0f4f8; /* Açık Mavi-Gri */
    --primary-blue: #1e88e5; /* Canlı Mavi */
    --primary-dark: #263238; /* Koyu Metin */
    --success-green: #4caf50; /* Doğru Yeşil */
    --danger-red: #e53935; /* Yanlış Kırmızı */
    --shadow-deep: 0 10px 30px rgba(0, 0, 0, 0.1);
    --shadow-button: 0 4px 15px rgba(30, 136, 229, 0.4);
  }

  body {
    font-family: 'Inter', sans-serif;
    text-align: center;
    background: linear-gradient(135deg, #e3f2fd, #bbdefb); /* Daha Canlı Gradient */
    margin: 0;
    padding: 30px 15px;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #card {
    max-width: 1000px;
    width: 100%;
    background: #fff;
    padding: 40px;
    border-radius: 20px; /* Yumuşak ve büyük köşeler */
    box-shadow: var(--shadow-deep);
    transition: transform 0.3s ease;
  }
  h1 {
    color: var(--primary-dark);
    font-weight: 800; /* Daha kalın başlık */
    font-size: 2.2rem;
    margin-bottom: 5px;
  }
  h2 {
    color: var(--primary-dark);
    margin: 25px 0 15px;
    font-weight: 700;
    font-size: 1.5rem;
  }
  p.small {
    color: #607d8b;
    font-size: 16px;
    margin-bottom: 30px;
  }

  /* BUTON GENEL STİLİ (Aksiyon Butonları) */
  .action-button, #resultButtons button {
    padding: 14px 30px;
    font-size: 16px;
    font-weight: 600;
    border-radius: 10px;
    border: none;
    background: var(--primary-blue);
    color: #fff;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.17, 0.84, 0.44, 1);
    box-shadow: var(--shadow-button);
  }
  .action-button:hover:not(:disabled), #resultButtons button:hover:not(:disabled) {
    background: #1565c0;
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(30, 136, 229, 0.6);
  }
  .action-button:active:not(:disabled), #resultButtons button:active:not(:disabled) {
    transform: translateY(0);
    box-shadow: 0 4px 15px rgba(30, 136, 229, 0.4);
  }
  .action-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* MENÜ BUTONLARI (KART EFEKTLİ) */
  #choices {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    margin-top: 30px;
  }
  #choices button {
    background: #ffffff;
    border: 2px solid #e0e0e0;
    color: var(--primary-dark);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    height: 120px;
    border-radius: 15px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 16px;
    font-weight: 700;
    transition: all 0.3s;
  }
  #choices button:hover {
    background: #e3f2fd;
    border-color: var(--primary-blue);
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(30, 136, 229, 0.3);
  }

  /* İKON STİLİ */
  #choices button span.icon {
    font-size: 2.5em;
    margin-bottom: 5px;
  }

  /* SORU SEÇENEKLERİ */
  #choicesArea button {
    background: var(--main-bg-color);
    color: var(--primary-dark);
    border: 1px solid #cfd8dc;
    box-shadow: none;
    width: 100%;
    max-width: 650px;
    margin: 12px auto;
    text-align: left;
  }
  #choicesArea button:hover:not(:disabled) {
    background: #d0e0f0;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* İLERLEME ÇUBUĞU */
  #progressWrap {
    height: 10px;
    background: #cfd8dc;
    border-radius: 5px;
    margin: 20px 0;
  }
  #progress {
    height: 100%;
    width: 0;
    background: linear-gradient(90deg, #42a5f5, var(--success-green)); /* Gradientli ilerleme */
    border-radius: 5px;
    transition: width 0.4s ease-out;
  }

  /* GERİ BİLDİRİM & SONUÇ STİLLERİ */
  #choicesArea button.correct-feedback {
    background-color: var(--success-green) !important;
    color: #fff;
    box-shadow: 0 4px 10px rgba(76, 175, 80, 0.5);
    transition: none;
  }
  #choicesArea button.wrong-feedback {
    background-color: var(--danger-red) !important;
    color: #fff;
    box-shadow: 0 4px 10px rgba(229, 57, 53, 0.5);
    transition: none;
  }
  #hint {
    font-size: 1.1rem;
    color: var(--primary-dark);
    margin-top: 15px;
    font-weight: 700;
    min-height: 25px;
  }
  .explain { color: var(--success-green); font-weight: 700; }
  .wrong { color: var(--danger-red); font-weight: 700; }
  .muted { color: #78909c; font-size: 14px; margin-top: 5px; }

  /* SONUÇ LİSTESİ */
  #resultBody ul {
    padding: 0;
    list-style: none;
    max-width: 800px;
    margin: 25px auto;
    text-align: left;
  }
  #resultBody li {
    background: #fff;
    padding: 18px;
    border-radius: 12px;
    margin-bottom: 15px;
    border-left: 6px solid var(--danger-red); /* Vurgulu sol çizgi */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  }

  @media(max-width: 768px) {
    #card { padding: 25px; border-radius: 15px; }
    h1 { font-size: 1.8rem; }
    #choices { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; }
    #choices button { height: 90px; font-size: 14px; padding: 8px; border-radius: 10px; }
    #choices button span.icon { font-size: 2em; }
  }
</style>
</head>
<body>
  <div id="card">
    <h1 id="title">Afet Bilinci Simülasyonu</h1>
    <p class="small" id="subtitle">Canlı senaryolarla afet bilincini geliştir. Yanlış cevaplarının detaylı analizini sonuç ekranında gör.</p>

    <div id="menu">
      <div id="choices"></div>
      <p class="menuNote muted" style="margin-top:30px;">Başlamadan önce bir senaryo seç ve bilgini test et.</p>
    </div>

    <div id="game" style="display:none">
      <div id="progressWrap"><div id="progress"></div></div>
      <h2 id="q"></h2>
      <div id="choicesArea"></div>
      <p id="hint"></p>
    </div>

    <div id="result" style="display:none">
      <h2 id="resultTitle"></h2>
      <div id="resultBody"></div>
      <div id="resultButtons" style="margin-top:30px">
        <button class="action-button" id="menuBtn">Ana Menüye Dön</button>
        <button class="action-button" id="restartBtn">Tekrar Çöz</button>
      </div>
    </div>
  </div>

<script>
let locked=false;
let type="", index=0;
let mistakes=[];
const progressEl = ()=>document.getElementById('progress');

// --- Ton Fonksiyonları (Sesler) ---
function playTone(freq,dur,vol=0.05){
  try{
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type='sine'; o.frequency.value = freq;
    g.gain.value = vol;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    setTimeout(()=>{ o.stop(); ctx.close(); }, dur);
  }catch(e){}
}
function correctSound(){ playTone(880,120,0.03); }
function wrongSound(){ playTone(220,220,0.04); }

// --- SENARYO VERİLERİ (Aynı kaldı) ---
const scenes = {
  deprem: [
    { q:"Deprem başladı! İlk tepkin ne olmalı?", o:["Panikle dışarı koşmak","Çök–Kapan–Tutun (güvenli pozisyon)","Camdan izlemek"], c:2, e:["Binalar ve camlar tehlikelidir. Dışarı koşmak daha tehlikeli olabilir.","Doğru: vücut korunur, yaralanma riski azalır.","Cam kırılabilir, tehlikeli."] },
    { q:"Güvende olmak için en güvenli yer neresidir?", o:["Kapı eşiği","Dayanıklı masa/çalışma masası altı","Pencere kenarı"], c:2, e:["Kapı eşiği eskiden önerilirdi ama güncel tavsiye masa altı.","Doğru: ağır nesnelerden korur.","Pencere kenarı cam tehlikesi nedeniyle yanlış."] },
    { q:"Dolap devrilmek üzereyken ne yapmalısın?", o:["Dolabı tutmayı denemek","Başını korumak (kask/ellerle)","Dolaptan uzaklaşıp pencereye koşmak"], c:2, e:["Dolabı tutmaya çalışmak yaralanmaya neden olabilir.","Doğru: baş ve boyun korunmalı.","Pencereye koşmak tehlikeli."] },
    { q:"Deprem bittiğinde ilk yapılacaklardan biri?", o:["Toplanma alanına gitmek","Eve geri dönmek","Elektrikleri açmak"], c:1, e:["Doğru: planlı toplanma güvenlidir.","Eve dönmek hasarlıysa tehlikeli.","Elektrikleri açmadan yetkililerin talimatı beklenir."] },
    { q:"Artçı sallantı hissedersen ne yapmalısın?", o:["Panikleyip koşmak","Tekrar çök–kapan–tutun","Binaya yaklaşmak"], c:2, e:["Kaçış sırasında düşme riski var.","Doğru davranış tekrardır.","Binalara yaklaşmak tehlikelidir (artçı çökme)."] },
    { q:"Asansörle mi yoksa merdivenle mi çıkmalısın?", o:["Asansör","Merdiven","Hiçbiri, binada kal"], c:2, e:["Asansörde mahsur kalma riski var.","Merdiven güvenlidir (hızlı ve kontrollü çıkış).","Binada kalmak bazen gerekebilir ama genelde toplanma alanına çıkış önerilir."] },
    { q:"Toplanma alanında ne yapmalısın?", o:["Acil durum talimatlarını dinlemek","Kendi kendine ayrıntılı arama yapmak","Sadece telefonla sosyal medyada paylaşmak"], c:1, e:["Doğru: yetkililerin talimatları önemlidir.","Aynı zamanda güvenlik riski oluşturabilir.","Yardım çağırmak iyidir ama yetkilileri takip et."] },
    { q:"Deprem sonrası yapman gereken doğru davranış nedir?", o:["Hasarı kontrol eder eve girerim","Yetkililere durumu bildiririm ve yardım ederim","Hiçbir şey yapmam"], c:2, e:["Eve girmek tehlikeli olabilir; yetkili izin gerekli.","Doğru: bilgi ve yardım önemlidir.","Hiçbir şey yapmamak yanlış."] }
  ],
  yangin: [
    { q:"Yangın anında ilk olarak ne yapılmalı?", o:["Yangını söndürmeye çalışmak (büyükse riskli)","Derhal kaçış yolunu kullanmak","Pencereye çıkıp izlemek"], c:2, e:["Küçük ve kontrol edilebiliyorsa söndürülür ama riskliyse öncelik kaçıştır.","Doğru: can güvenliği öncelikli.","İzlemek tehlikeli ve yanlış."] },
    { q:"Kapıdan önce kontrol etmen gereken nedir?", o:["Kapının hemen açılması","Kapının sıcaklığı (el/önkol ile)","Pencereyi açmak"], c:2, e:["Açmak alev veya dumanla karşılaşmana neden olur.","Doğru: sıcaklık kontrolü güvenlik sağlar.","Pencereyi açmak dumanı çekebilir, genelde önerilmez."] },
    { q:"Duman yoğun ise nasıl ilerlemelisin?", o:["Ayakta yürümek","Eğilerek/zemine yakın yürümek","Koşmak"], c:2, e:["Ayakta duman solunmasını artırır.","Doğru: temiz hava düşük seviyededir.","Koşmak düşme ve boğulma riskini artırır."] },
    { q:"Ateş hızla yayılıyorsa ne yapmalısın?", o:["Panikle pencereden atlamak","Panik yapmadan çıkışa yönelmek","Dolaba saklanmak"], c:2, e:["Atlamak ağır yaralanma riski taşır.","Doğru: kontrollü kaçış en güvenli.","Dolap saklanmak ölümcül olabilir."] },
    { q:"Kapının arkasında duman varsa, ne yapmalısın?", o:["Zorla açmak","Islak bezle kapıyı kapatıp alternatif yol aramak","Orada beklemek"], c:2, e:["Zorla açmak alevi hızla içeri alır.","Doğru: ıslak örtü duman girişini azaltır ve alternatif arama gerekir.","Beklemek tehlikelidir."] },
    { q:"Dışarıdayken ne yapmalısın?", o:["Yangını çekim amaçlı izlemek","112/110'u arayıp bilgi vermek","Eve geri dönüp eşya almak"], c:2, e:["Paylaşmak tehlikeli ve yardım geciktirir.","Doğru: acil servisi bilgilendir.","Eşyaları almak hayat riski oluşturur."] },
    { q:"Yanık yaralısı gördün, ilk yardım ne olmalı?", o:["Yanığı soğuk suyla yıkamak ve yardım çağırmak","Yanığa krem sürüp beklemek","Hemen üzerini açıp ovmak"], c:1, e:["Doğru: soğuk su yanık tedavisinin ilk adımıdır.","Kremler profesyonel kontrol sonrası.","Ovmak enfeksiyon riskini artırır."] },
    { q:"Yangın söndüğünde yapılacak ilk şey nedir?", o:["Yetkililerin talimatına uymak","Hemen eve geri dönmek","Olay yerinin fotoğrafını çekip paylaşmak"], c:1, e:["Doğru: yetkililerin yönlendirmesi hayati.","Eve dönmek tehlikeli olabilir.","Paylaşmak yanlış bilgiler yayabilir."] }
  ],
  sel: [
    { q:"Ani yağışta su yükseliyorsa ilk tepkin ne olur?", o:["Arabadayım, beklerim","Yüksek yere/katlara çıkarım","Suyu fotoğraflarım"], c:2, e:["Arabada su yükselince sıkışma riski yüksek.","Doğru: yükseğe ve güvenli bölgeye çık.","Fotoğraf çekmek yardım etmez."] },
    { q:"Dere kenarında su yükseliyorsa ne yapmalısın?", o:["Dereye yaklaşırım","Hemen uzaklaşırım","Suya girip kurtarmaya çalışırım"], c:2, e:["Yaklaşmak sürüklenme riskini artırır.","Doğru: uzaklaş ve yetkilileri uyar.","Suya girmek profesyonel ekip işi."] },
    { q:"Sel alarmı verildiyse eve mi kalmalısın?", o:["Eve kalırım ve yüksek kata çıkarım","Pencereden izlerim","Evi terk edip açık alana çıkarım"], c:1, e:["Eğer içerideysen yüksek kata çıkmak daha güvenli olabilir.","İzlemek risk oluşturur.","Açık alana geçme kriterlere göre değişir."] },
    { q:"Araç içinde su yükseliyorsa ne yapılmalı?", o:["Motora güvenip beklerim","Aracı terk edip yükseğe çıkarım","Arabada kalırım çünkü güvenli"], c:2, e:["Motor güvende değil; su yükseldikçe tehlike artar.","Doğru: araç terk edilip güvenli yere.","Arabada kalmak boğulma riski taşır."] },
    { q:"Sel sonrası temiz suya nasıl erişmelisin?", o:["Kirli suyu içebilirim","Yetkililerin sağladığı dağıtımı beklerim","Her çeşme güvenlidir"], c:2, e:["Kirli su sağlık riski taşır.","Doğru: yetkililerin yönlendirmesi ve dağıtımı bekle.","Her çeşme kontaminasyona açık olabilir."] },
    { q:"Sel bölgesinde elektrik riski varsa ne yapmalısın?", o:["Elektriği açarım","Elektrik kaynaklarından uzak dururum","Suya metal eşyalar atarım"], c:2, e:["Elektriği açmak tehlikeli olabilir.","Doğru: elektrik kaynaklarından uzak dur.","Metal atmak tehlikeli."] },
    { q:"Sel bölgesinde yardım gerekiyorsa ne yaparsın?", o:["Kendi başıma tehlikeli arama yaparım","Yetkilileri bilgilendiririm ve güvenli davranırım","Televizyona bağlanırım"], c:2, e:["Kendi arama tehlikeli olabilir.","Doğru: yetkilileri bilgilendir ve güvenli kal.","Medya öncelikli değil."] },
    { q:"Sel sonrası hangi eşyaları ilk kontrol etmelisin?", o:["Gıda ve su kaynaklarını","Sadece eşyaları","Elektrikli cihazları hemen kullanırım"], c:1, e:["Doğru: gıda-su öncelikli, güvenlik kritik.","Sadece eşyalar yanlış öncelik.","Elektrikli cihazlar kontrol edilmeden tehlikeli olabilir."] }
  ],
  heyelan: [
    { q:"Şiddetli yağmurda toprak hareketi hissedersen ne yaparsın?", o:["Aşağıya doğru koşarım","Yukarı ve içeri doğru hareket ederim","Durup beklerim"], c:2, e:["Aşağıya koşmak heyelana yaklaştırır.","Doğru: yüksek, sağlam bölgeye gitmek gerek.","Beklemek toplanma riskini artırır."] },
    { q:"Ev yakınında çatlaklar görürsen ne yapmalısın?", o:["Durumu görmezden gelirim","Yetkililere bildiririm ve güvenli bölgeye geçerim","Eşyaları toplamaya başlarım"], c:2, e:["Görmezden gelmek risklidir.","Doğru: erken bildirim can kurtarır.","Eşyaları almak tehlikeli olabilir."] },
    { q:"Yamaçtan sesler geliyorsa ne yapmalısın?", o:["Ağır eşya ile alanı kontrol ederim","Hemen uzaklaşırım","Fotoğraf çekip paylaşırım"], c:2, e:["Eşya ile müdahale tehlikeli.","Doğru: hızlı uzaklaşma hayati.","Fotoğraf yardım etmez, zaman kaybettirir."] },
    { q:"Heyelan bölgesinde araçla hareket ediyorsan?", o:["Hızlı geçerim","Yavaşça ve dikkatle uzaklaşırım","Araçla durur beklerim"], c:2, e:["Hızlı geçiş kayma riskini artırır.","Doğru: kontrollü uzaklaşma gerekir.","Araçta beklemek tehlikelidir."] },
    { q:"Ev heyelan riski altındaysa ne yapmalısın?", o:["Acil durum planı uygularım","Eşyaları toplamaya çalışırım","Hiçbir şey yapmam"], c:1, e:["Doğru: plan ve hızlı hareket hayati.","Eşyaları almak zaman kaybettirir.","Hiçbir şey yapmak tehlikelidir."] },
    { q:"Toprak kayması sonrası ne yapmalısın?", o:["Hasarı kendi başıma temizlerim","Yetkililerin iznini ve yardımını beklerim","Derhal eve girerim"], c:2, e:["Kendi başına temizleme tehlikeli olabilir.","Doğru: yetkililer ve ekipler gerekli.","Eve girmek çökme riskini artırabilir."] },
    { q:"Yağış devam ediyorsa nerede kalmalısın?", o:["Alçakta, vadide","Yüksekte ve sağlam zeminde","Sel yataklarında"], c:2, e:["Alçak yerler su toplar, tehlikelidir.","Doğru: yüksek ve sağlam yer güvenlidir.","Sel yatakları tehlikeli."] },
    { q:"Heyelan anında en güvenli hareket nedir?", o:["Yükseğe ve yan tarafa doğru hızlıca kaçmak","Duvarda saklanmak","Yere yatmak"], c:1, e:["Doğru: yamaçtan uzaklaşıp yüksek noktaya gitmek.","Duvarda saklanmak göçük riski taşır.","Yere yatmak etkilidir mi belirsiz ve risklidir."] }
  ],
  firtina: [
    { q:"Fırtına anında ilk korunma olarak ne yapmalısın?", o:["Açık alanda kalırım","Sağlam kapalı bir binaya girerim","Ağaç altına saklanırım"], c:2, e:["Açık alan risklidir (yıldırım, uçan nesneler).","Doğru: sağlam kapalı alan güvenlidir.","Ağaç altı devrilme/yıldırım risklidir."] },
    { q:"Deniz kenarında fırtına varsa ne yapmalısın?", o:["Denize açılırım","Kıyıdan uzaklaşıp güvenli yüksek yere çıkarım","Deniz kıyısında beklerim"], c:2, e:["Denize çıkmak ölümcül risk taşır.","Doğru: kıyıdan uzaklaş ve yüksel.","Kıyıda kalmak tehlikelidir."] },
    { q:"Rüzgâr çok kuvvetliyse araç kullanırken?", o:["Hızlanırım ve geçerim","Yavaşlar kenara çekilirim","Araçta sabit dururum"], c:2, e:["Hızlanma kontrol kaybı yaratır.","Doğru: yavaşlayıp güvenli yerde bekle.","Araçta kalmak bazen gerekli ama kenara çekilmek daha güvenli."] },
    { q:"Fırtına sırasında cam uçağı vb nesneler için ne yapmalısın?", o:["Pencereleri kapatır, perdeleri kapatırım","Pencereleri açık bırakırım","Camın önünde dururum"], c:1, e:["Doğru: cam koruma ve içeride güvenlik sağlar.","Açık bırakmak tehlikeli.","Cam önünde durmak tehlikelidir."] },
    { q:"Yıldırım çarpması riskinde ne yapmalısın?", o:["Metalik eşyaları yere bırakırım ve içeri girerim","Açıkta kalıp gökyüzünü izlerim","Yüksek yere çıkıp beklerim"], c:1, e:["Doğru: metalden uzaklaş ve içeri gir.","Açıkta kalmak ölümcül risktir.","Yükseğe çıkmak riski artırır."] },
    { q:"Fırtına sonrası evde kontrol etmen gereken ilk şey?", o:["Elektrik hatları ve gaz kaçaklarını kontrol etmek","Hemen televizyonu açmak","Eşyaları karıştırmak"], c:1, e:["Doğru: güvenlik riski önceliklidir.","Televizyon veya eğlence öncelik olmamalı.","Rastgele eşyaları karıştırmak tehlike doğurur."] },
    { q:"Güçlü rüzgâr sırasında dışarıdayken nereye sığınmalısın?", o:["Açık garaja/garaj önü","Küçük kafe tente altı","Sağlam iç mekâna"], c:3, e:["Açık garage uçuşan cisimlere açıktır.","Tente altı uçuşan parçalara açık olabilir.","Doğru: sağlam iç mekan korur."] },
    { q:"Fırtına uyarısı varken en iyi hazırlık nedir?", o:["Dışarda eşyaları sabitlemek ve acil çanta hazırlamak","Hiçbir hazırlık yapmamak","Denize gitmek"], c:1, e:["Doğru: hazırlık riskleri azaltır.","Hazırlık yapmamak tehlikelidir.","Denize gitmek ölümcül risktir."] }
  ],
  cig: [ 
    { q:"Kışın dağlık bir bölgede iseniz ve çığ uyarısı varsa ne yapmalısınız?", o:["Uyarıları göz ardı ederek kayak yapmaya devam ederim","Belirlenen güvenli bölgelerde kalırım","Yüksek ses çıkararak karı test ederim"], c:2, e:["Uyarıları göz ardı etmek hayati tehlikeye yol açar.","Doğru: yetkililerin ve çığ uzmanlarının belirlediği güvenli alanlarda kalın.","Yüksek ses, titreşim oluşturarak çığ riskini artırabilir."] },
    { q:"Yürüyüş sırasında çığ sesi duyarsanız ilk tepkiniz ne olmalıdır?", o:["Kaçmaya çalışmak (aşağı doğru)","Hemen sırt çantanızı çıkarıp yere yatmak","En yakın sağlam cisme tutunmaya çalışmak"], c:3, e:["Aşağı doğru kaçmak, çığın hızlanma riskini artırır.","Sırt çantasını çıkarmak bazen önerilir ama öncelik sağlam bir yere tutunmaktır.","Doğru: bir ağaç, kaya gibi sağlam bir cisme tutunarak sürüklenmeyi önleyin."] },
    { q:"Çığ altında kalırsanız ne yapmalısınız?", o:["Panikleyerek enerjiyi hızlıca tüketmek","Kar durmadan önce ellerle yüz çevresinde bir hava boşluğu oluşturmaya çalışmak","Bağırmaya başlamak"], c:2, e:["Panik oksijen tüketimini hızlandırır.","Doğru: kar durmadan önce etrafınızdaki karı iterek ağız ve burun çevrenizde bir hava cebi oluşturun.","Kar sesi havayı iletmez, bağırmak enerjiyi tüketir."] },
    { q:"Çığ altında kaldıktan sonra kar durduğunda yönünüzü nasıl belirlersiniz?", o:["Tahmini bir yön seçerek kazmaya başlamak","Tükürerek yerçekimi yönünü (aşağı) bulmak","Karın en yumuşak olduğu yöne doğru kazmak"], c:2, e:["Tahminler yanıltıcı olabilir.","Doğru: ağzınıza tükürerek veya salya bırakarak yerçekiminin hangi yönde olduğunu (aşağıyı) tespit edin ve tam tersi yöne kazın.","Karın yumuşaklığı yönü göstermez."] },
    { q:"Yamaçta hareket eden bir çığ gördüğünüzde ne yapmalısınız?", o:["Fotoğraf çekmek için yaklaşmak","Çığ hattından yatay ve hızlıca uzaklaşmak","Kar motoru ile çığın önünden kaçmaya çalışmak"], c:2, e:["Fotoğraf çekmek zaman kaybettirir ve risklidir.","Doğru: çığ yolu üzerinden yatay bir açıyla hızlıca kaçarak güvenli bölgeye geçin.","Kar motoru tehlikelidir ve çığın önünden kaçılamayabilir."] },
    { q:"Çığ tehlikesi olan bir bölgeye girerken yanınıza ne almalısınız?", o:["Sadece yiyecek ve içecek","Çığ cihazı (transceiver), kürek, prob (sonda)","Radyo ve battaniye"], c:2, e:["Yiyecekler önemlidir ama hayati değildir.","Doğru: çığ üçlüsü (cihaz, kürek, prob) kurtarma için zorunludur.","Bunlar gerekli ama çığ kurtarma araçları kadar öncelikli değil."] },
    { q:"Çığdan kurtulduktan sonra birini ararken hangi kurtarma yöntemini kullanmalısınız?", o:["Gözle rastgele arama","Sadece bağırarak çağırmak","Çığ cihazını (transceiver) kullanarak sinyal takibi yapmak"], c:3, e:["Gözle arama yeterli değildir.","Bağırmak önemlidir ama cihaz olmadan nokta atışı yapamazsınız.","Doğru: çığ cihazı, gömülü kişinin yerini hassas bir şekilde belirlemek için temel araçtır."] },
    { q:"Çığ anında bir arabanın içindeyseniz en güvenli davranış nedir?", o:["Arabadan inip karın üstüne çıkmaya çalışmak","Aracı terk etmeden motoru kapatıp emniyet kemerini çözmek","Hızla geri geri giderek çığdan uzaklaşmak"], c:2, e:["Arabadan inmek daha çok riske atar.","Doğru: Motoru kapatıp zehirlenmeyi önleyin ve kemeri çözerek kar durduğunda hareket serbestliği kazanın.","Hızla uzaklaşmak karda zor ve tehlikelidir."] }
  ],
  kbrn: [ 
    { q:"Kimyasal bir sızıntı alarmı duyarsanız ilk olarak ne yapmalısınız?", o:["Hemen maske takıp dışarı çıkmak","Pencere ve kapıları kapatıp 'İçeride Kal' (Shelter in Place) kuralını uygulamak","Sızıntı kaynağını bulmaya çalışmak"], c:2, e:["Kimyasal sızıntı varsa dışarıdaki hava kapalı alandan daha tehlikelidir.","Doğru: Sızdırmazlık sağlayarak içeride kalmak, havayla temas eden kimyasallardan korunmanın en hızlı yoludur.","Kaynak aramak yetkililerin işidir, kendi güvenliğiniz öncelikli."] },
    { q:"Radyolojik bir tehlike uyarısı varsa nerede korunmak en güvenlidir?", o:["Binanın en üst katı","Binanın orta katları veya bodrum katı","Açık bir otopark"], c:2, e:["Üst katlar radyasyona karşı daha az korunaklıdır.","Doğru: Kalın duvarlar ve katlar radyasyona karşı koruma sağlar. Bodrums en güvenli yerdir.","Açık alanlar tehlikelidir."] },
    { q:"Biyolojik tehlike (örn. salgın) ilan edilirse en temel kişisel koruma önlemi nedir?", o:["Sürekli antiseptik sprey kullanmak","Maske takmak, el hijyenine dikkat etmek ve sosyal mesafeyi korumak","Vitamin takviyesi almak"], c:2, e:["Sürekli sprey tehlikelidir.","Doğru: Bulaşma riskini en aza indiren en etkili yöntemlerdir.","Vitaminler destekler ama bulaşmayı engellemez."] },
    { q:"Nükleer bir patlama sonrası dışarıdaysanız ne yapmalısınız?", o:["Derhal kapalı ve sağlam bir yere sığınmak","Hemen eve dönüp banyo yapmak","Uzun süre dışarıda kalarak durumu gözlemlemek"], c:1, e:["Eve dönüp banyo yapmak doğrudur ancak öncelik derhal korunmaktır.","Doğru: Radyoaktif serpintiden korunmak için en kısa sürede sağlam bir sığınağa girilmelidir.","Dışarıda kalmak serpintiye maruziyeti artırır."] },
    { q:"Kıyafetlerinize kimyasal madde bulaştığından şüpheleniyorsanız ne yapmalısınız?", o:["Kıyafetleri ovuşturarak temizlemeye çalışmak","Kıyafetleri çıkarıp plastik bir torbaya koymak ve cildi bol suyla yıkamak","Kıyafetlerle birlikte evin içine girmek"], c:2, e:["Ovmak kimyasalın daha çok yayılmasına neden olur.","Doğru: Kirlenmiş giysiler hemen çıkarılmalı ve plastik bir torbada izole edilmeli, ardından vücut temizlenmelidir.","İçeri girmek kontaminasyonu yayar."] },
    { q:"KBRN olayında acil yardım ekiplerini ararken hangi bilgiyi kesinlikle vermelisiniz?", o:["Sadece kendi adımı ve adresimi","Tehlikenin türü (kimyasal, biyolojik vs.) ve tam konumu","Sosyal medyada gördüğüm bilgileri"], c:2, e:["Adres önemlidir ama tehlike türü öncelikli.","Doğru: Ekiplerin doğru koruyucu ekipmanla gelmesi ve doğru prosedürü uygulaması için bilgi çok önemlidir.","Sosyal medya bilgileri yanıltıcı olabilir."] },
    { q:"Toplu taşımadayken şüpheli bir paket/nesne görürseniz ne yapmalısınız?", o:["Paketi açıp kontrol etmek","Yetkililere (polis/güvenlik) durumu bildirmek ve alanı terk etmek","Sadece yanındakilere söylemek"], c:2, e:["Paketi açmak tehlikelidir.","Doğru: Güvenlik birimlerini uyarın ve paketle aranıza mesafe koyun.","Yetkili mercilere bildirim zorunludur."] },
    { q:"KBRN olayında en önemli iletişim kuralı nedir?", o:["Sürekli telefonla konuşarak hattı meşgul etmek","Kısa mesaj veya internet tabanlı uygulamaları kullanmak","Haberleri sürekli yüksek sesle takip etmek"], c:2, e:["Telefon hatları acil durumlar için serbest bırakılmalıdır.","Doğru: SMS ve veri tabanlı iletişim, sesli görüşmeye göre daha az bant genişliği kullanır.","Haberleri takip etmek önemlidir ama iletişim önceliği farklıdır."] }
  ],
  ilkyardim: [ 
    { q:"Bilinci kapalı bir yaralı gördüğünüzde ilk olarak ne yapmalısınız?", o:["Hemen hastaneye götürmeye çalışmak","Önce kendi güvenliğinizi sağlamak ve 112'yi aramak","Yaralıyı sallayarak uyandırmaya çalışmak"], c:2, e:["Yardım çağrılmadan taşımak yaralanmayı artırabilir.","Doğru: Önce olay yeri güvenliği, sonra yardım çağrısı.","Sarsmak boyun ve omurilik hasarını artırabilir."] },
    { q:"Ciddi bir dış kanama varsa ilk yardım nasıl olmalıdır?", o:["Kanayan bölgeyi kalpten aşağıda tutmak","Temiz bir bezle baskı uygulamak ve bölgeyi yukarı kaldırmak","Yarayı sabunlu suyla yıkamak"], c:2, e:["Kanayan bölgeyi aşağıda tutmak kanamayı artırır.","Doğru: Baskı ve yükseltme, kanamayı kontrol altına almada temel adımlardır.","Yıkama, kanama kontrol altına alındıktan sonra düşünülür."] },
    { q:"Yetişkin birine kalp masajı yaparken göğüs kemiği ne kadar çöktürülmelidir?", o:["1-2 cm","5-6 cm","10 cm"], c:2, e:["1-2 cm yetersizdir.","Doğru: Kalbin etkili bir şekilde sıkıştırılması için $5-6$ cm çökme gerekir.","10 cm çok fazladır ve kaburga kırılmasına yol açabilir."] },
    { q:"Bir bebekte (0-1 yaş) tıkanma varsa yabancı cismi nasıl çıkarmaya çalışırsınız?", o:["Karın bölgesine Heimlich manevrası uygulamak","Sırtına 5 kez süpürür tarzda vurmak ve 5 kez göğüs basısı yapmak","Sadece su içirmeye çalışmak"], c:2, e:["Heimlich manevrası bebekler için uygun değildir.","Doğru: Süpürür tarzda sırt vuruşu ve göğüs basısı bebeklerde temel tıkanma giderme yöntemidir.","Su içirmek durumu daha kötü yapabilir."] },
    { q:"Yanığa ilk müdahale nasıl olmalıdır?", o:["Yanığa yoğurt/diş macunu sürmek","Yanığı $15-20$ dakika soğuk (buzlu değil) su altında tutmak","Kıyafetleri zorla çıkartmak"], c:2, e:["Yoğurt/macun enfeksiyon riskini artırır.","Doğru: Soğuk su, yanığın ilerlemesini durdurur ve acıyı hafifletir.","Kıyafet yapıştıysa zorla çıkartılmamalıdır."] },
    { q:"Kırık şüphesi olan bir uzvu nasıl sabitlemelisiniz?", o:["Kırık bölgeyi düzeltmeye çalışmak","Yaralı bölgeyi hareketsiz bırakıp iki yanındaki eklemi de içerecek şekilde desteklemek","Sadece ağrı kesici vermek"], c:2, e:["Kırığı düzeltmek daha büyük hasara yol açar.","Doğru: Sabitleme (atel), kırık olan bölgenin ve komşu eklemlerin hareketini önler.","Ağrı kesici, tedavinin bir parçasıdır ama sabitleme önceliklidir."] },
    { q:"Şok belirtileri (solgunluk, soğuk terleme, hızlı nabız) gösteren birine ne yapılmalıdır?", o:["Oturur pozisyonda tutmak","Ayaklarını $30$ cm kadar yükseltmek ve üzerini örtmek","Sıcak içecekler vermek"], c:2, e:["Oturur pozisyon beyin kanlanmasını azaltabilir.","Doğru: Ayakları yükseltmek beyne kan akışını artırır. Üstünü örtmek vücut ısısını korur.","Sıvı/yiyecek verilmemelidir."] },
    { q:"Yaralıya ilk yardım yapmadan önce neye dikkat etmelisiniz?", o:["Elbiselerinin markasına","Yaralının tüm hikâyesini dinlemeye","Eldiven takmak ve hijyene dikkat etmek"], c:3, e:["Elbise markası önemsizdir.","Hikâye önemlidir ama öncelik kendi güvenliğinizdir.","Doğru: Eldiven ve hijyen, hem kendinizi hem de yaralıyı enfeksiyondan korur."] }
  ]
};


// --- FONKSİYONLAR ---

function start(t){
  type=t; index=0; mistakes=[]; locked=false;
  document.getElementById('menu').style.display='none';
  document.getElementById('result').style.display='none';
  document.getElementById('game').style.display='block';
  updateProgress();
  renderScene();
}

function updateProgress(){
  const total = scenes[type].length;
  const pct = Math.round((index/total)*100);
  progressEl().style.width = pct + '%';
}

function renderScene(){
  if(!scenes[type]) return;
  const total = scenes[type].length;
  if(index >= total) return showResults();
  const s = scenes[type][index];
  document.getElementById('q').innerHTML = <strong>Soru ${index + 1}/${total}:</strong> ${s.q};
  const choicesArea = document.getElementById('choicesArea');
  choicesArea.innerHTML = '';
  document.getElementById('hint').innerText = '';
  
  const currentSceneIndex = index;
  
  s.o.forEach(function(opt,i){
    const b = document.createElement('button');
    b.classList.add('action-button');
    b.textContent = opt;
    b.setAttribute('data-index', i + 1);
    b.addEventListener('click', function(){
      if(locked || currentSceneIndex !== index) return;
      locked=true;
      
      const isCorrect = (i + 1 === s.c);
      const allButtons = choicesArea.querySelectorAll('button');

      // Butonları renklendirme ve devre dışı bırakma
      allButtons.forEach(btn => {
          const btnIndex = parseInt(btn.getAttribute('data-index'));
          btn.disabled = true;
          
          if(btnIndex === s.c){
              btn.classList.add('correct-feedback');
          } else if (btnIndex === (i + 1)){
              btn.classList.add('wrong-feedback');
          }
      });
      
      if(isCorrect){
        correctSound();
        document.getElementById('hint').innerText = 'Doğru Cevap! ✔ Mükemmel!';
      } else {
        wrongSound();
        const why = s.e && s.e[i] ? s.e[i] : 'Bu seçenek doğru değil.';
        mistakes.push({sceneIndex:index+1, question:s.q, selected:opt, correct:s.o[s.c-1], why:why});
        document.getElementById('hint').innerText = 'Yanlış Cevap. Açıklaması sonuçta.';
      }
      
      index++;
      updateProgress();
      setTimeout(function(){ 
          // 1.5 saniye bekleme süresi
          locked=false;
          renderScene(); 
      }, 1500); 
    });
    choicesArea.appendChild(b);
  });
  updateProgress();
}


function showResults(){
  document.getElementById('game').style.display='none';
  document.getElementById('result').style.display='block';
  document.getElementById('resultTitle').innerText = capitalize(type) + ' Senaryosu Tamamlandı!';
  
  const totalQuestions = scenes[type].length;
  const correctCount = totalQuestions - mistakes.length;
  
  let body = '';
  if(mistakes.length === 0){
    body = <p class="explain" style="font-size:1.4rem;">Tebrikler! Tüm soruları doğru bildin. Bir Afet Kahramanısın! 🌟</p>;
  } else {
    body = <p style="font-size:1.2rem; color:var(--primary-dark); font-weight:600;">Başarı Oranı: %${Math.round((correctCount/totalQuestions)*100)} (${correctCount}/${totalQuestions} Doğru)</p> +
           <p class="muted">Yanlış yaptığın ${mistakes.length} sahnenin detaylı analizi aşağıdadır:</p><ul>;
           
    mistakes.forEach(function(m){
      body += '<li><p style="margin:0"><b>Sahne ' + m.sceneIndex + ':</b> ' + escapeHtml(m.question) + '</p>' +
        '<p class="wrong" style="margin:3px 0;">Seçimin: ' + escapeHtml(m.selected) + '</p>' +
        '<p class="explain" style="margin:3px 0;">Doğrusu: ' + escapeHtml(m.correct) + '</p>' +
        '<p class="muted" style="margin:3px 0;">Öğrenilmesi Gereken: ' + escapeHtml(m.why) + '</p></li>';
    });
    body += '</ul>';
  }
  document.getElementById('resultBody').innerHTML = body;
  
  // Buton eventleri yeniden tanımlanıyor
  document.getElementById('menuBtn').onclick = backToMenu;
  document.getElementById('restartBtn').onclick = restart;
  
  progressEl().style.width = '100%';
}

function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1); }
function escapeHtml(s){ return (s+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function backToMenu(){
  document.getElementById('result').style.display='none';
  document.getElementById('game').style.display='none';
  document.getElementById('menu').style.display='block';
  document.getElementById('title').innerText = 'Afet Bilinci Simülasyonu';
  document.getElementById('subtitle').innerText = "Canlı senaryolarla afet bilincini geliştir. Yanlış cevaplarının detaylı analizini sonuç ekranında gör.";
  progressEl().style.width = '0%';
}
function restart(){ start(type); }

function showMainMenu(){
  const choices = document.getElementById('choices');
  choices.innerHTML = '';
  const scenarios = ['deprem','yangin','sel','heyelan','firtina', 'cig', 'kbrn', 'ilkyardim'];
  const icons = ['🌋','🔥','🌊','🗻','🌪️', '🏔️', '☢️', '🩹'];
  const names = ['Deprem','Yangın','Sel','Heyelan','Fırtına', 'Çığ', 'KBRN','Temel İlkyardım'];
  
  scenarios.forEach(function(sc,idx){
    const btn = document.createElement('button');
    btn.innerHTML = <span class="icon">${icons[idx]}</span>${names[idx]};
    btn.onclick = function(){ start(sc); };
    choices.appendChild(btn);
  });
}

window.onload = function(){
  document.getElementById('menu').style.display='block';
  document.getElementById('game').style.display='none';
  document.getElementById('result').style.display='none';
  progressEl().style.width='0%';
  showMainMenu();
};
</script>
</body>
</html>
